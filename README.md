# tween-animate

## new version v3 is launched
- [tween-animate](#tween-animate)
  - [new version v3 is launched](#new-version-v3-is-launched)
  - [example](#example)
  - [Animate](#animate)
    - [usage](#usage)
    - [to](#to)
    - [options](#options)
    - [property](#property)
  - [animate](#animate-1)
    - [re-config animate](#re-config-animate)
    - [eventlistener](#eventlistener)
    - [transform](#transform)
    - [apply](#apply)
  - [instance](#instance)
    - [events](#events)
  - [transforms](#transforms)
    - [transforms list](#transforms-list)
    - [custom transform](#custom-transform)
  - [faster tween animate](#faster-tween-animate)
  - [get start](#get-start)
    - [todo](#todo)
  - [develop](#develop)
    - [install](#install)
    - [start](#start)
    - [test](#test)
    - [template](#template)
    - [build](#build)

## example
[Codepen exmaple](https://codepen.io/voderl/pen/PozZBXj)
```js
import Animate from 'tween-animate';

const { Easing } = Animate;

// internal requestAnimationFrame start
Animate.play();

const animate = Animate({
  x: 100,
  y: (v) => v + 100,
}, {
  time: 1000,
  easing:Easing.Quadratic.In,
  isAssign: false,
}).transform('yoyo').on('update', e => console.log(e));

animate.apply({
  x: 0,
  y: 0
});
// tween to {x: 100, y: 100}
```

## Animate 
### usage
```js
const animate = Animate(to, options);
const instance = animate.apply(from);
```
```js
const instance = Animate(from, to, options);
```
### to
* `number`
  ```js
  Animate(100, 1000).apply(0);
  ```
* `object`
  ```js
  Animate({
    x: 100,
    y: 100
  }, 1000).apply({
    x: 0,
    y: 0
  });
  ```
* `function`
   ```js
  Animate((from) => ({
    x: from.x + 100,
    y: from.y + 100,
  }), 1000).apply({
    x: 0,
    y: 0
  });
  ```
* the above types can be nested
  
### options
* `number`:  time   
  ```js
  // tween from 0 to 1 last 1000ms
  Animate(1, 1000).apply(0);
  ```
* object
  ```ts
  {
    time: number,
    easing: (v: number) => number;
    isAssign: boolean;
    list: any[];
  }
  ```
  * easing - default  `Easing.Linear.None`  
    [all Easing function](https://tweenjs.github.io/tween.js/examples/03_graphs.html)
    ```js
    Animate(0, 1, {
      time: 1000,
      easing: Animate.Easing.Linear.None,
    });
    ```
  * isAssign - default `true`
    ```js
    const a = Animate({
      x: 100,
      y: 100
    }, {
      time: 1000,
      isAssign: true,
    });
    const b = a.config({
      isAssign: false,
    })
    const v1 = {x: 0, y: 0};
    const v2 = { x: 0, y: 0};
    a.apply(v1);
    b.apply(v2);
    // after tweening
    console.log(v1); // { x: 100, y: 100}
    console.log(v2); // {x: 0, y: 0}; 
    ```
  * list - you can use custom list to control
    ```js
    const customList = [];
    const a = Animate(100, {
      time: 1000,
      isAssign: true,
      list: customList,
    }).apply(0);
    Animate.update(); // don't work;
    Animate.update(customList); // work
    ```
### property
* play - `function`
  ```js
  // internal requestAnimationFrame start
  Animate.play();
  ```
* stop - `function`
  ```js
  // internal requestAnimationFrame stop
  Animate.stop();
  ```
* update - `function`  
  `update(list?: any[])`
  ```js
  const { update }  = Animate;
  function ticker() {
    requestAnimationFrame(animate)
    update();
  }
  requestAnimationFrame(ticker);
  ```
* updateElpased - `function`  
  `update(elpased: number, list?: any[])`
  ```js
  const { updateElpased }  = Animate;
  updateElpased(1000); // update 1000 ms;
  ```
* Easing - [`Easing funciton list`](https://tweenjs.github.io/tween.js/examples/03_graphs.html)
  ```js
  const { Easing } = Animate;
  ```

## animate
animate is generated by Animate Function
```js
const animate = Animate({
  x: 100,
  y: 100
}, 1000);
```
### re-config animate
```js
const animate2 = animate.config({
  time: 600
});
const animate3 = animate({
  time: 600
});
animate2 !== animate3;// but they behaves in same way
```
### eventlistener
```js
// add listener
animate.on('start', () => {});
// add listener only excute once
animate.once('update', () => {});
// remove listener
animate.off('complete', () => {});
```
events will listen to "instance", please see [instance events](#events)

### transform
```js
animate.transform('loop', 2);
```
all transforms please see [transform section](#transforms) in the following

### apply
```js
animate.apply({x: 0, y: 0});
animate.apply({x: 0, y: 0}, {x: 50, y: 50});
```

## instance
instance generated by animate
```js
const instance = animate.apply({
  x: 0,
  y: 0
})
```

### events
* start
* update
  ```js
  Animate(1, 1000).apply(0);
  // update 0.5
  Animate(1, 1000).apply(0, 0, 0);
  // update [0.5, 0.5, 0.5]
  ```
* complete


## transforms
transforms will directly change instance, but you can call transform in `animate` to avoid

```js
const animate = Animate(1, 1000);
const ins_loop2 = animate.apply(0).transform('loop', 2);


const animate_loop2 = animate.transform('loop', 2);
const animate_loop4 = animate_loop2.transform('loop', 2);

const a = animate_loop2.apply(0); // loop 2
const b = animate_loop4.apply(0); // loop 4
```
### transforms list
* loop - `transform('loop', count)`
* reverse 
* yoyo
* delay - `transform('delay', delayTime)`
* step - `transform('step', steps)`
  ```js
  Animate(0, 1, 1000).transform('step', 10).on('update', console.log);
  /* log:
  0.1
  0.2
  ...
  1.0; 
  */
  ```
* the above transforms can be nested
  ```js
  animate.transform('loop', 2).transform('yoyo');
  animate.transform('yoyo').transform('loop',2);
  // the above two behave different
  ```
### custom transform
see https://github.com/voderl/tween-animate/blob/v3/src/transform/index.ts
```ts
Animate.registerTransform('speed', (ins: AnimateInstance, speed: number) => {
  ins.fullTime /= speed;
});
```

## faster tween animate

https://voderl.github.io/tween-animate/performance/  

32*32 image's imageData (array of 4096 values)，use [tween-animate](https://github.com/voderl/tween-animate) and [tween.js](https://github.com/tweenjs/tween.js) to transform，you can open chrome devtools "performance" tab to test

```js
parseFromTo(
  { x: [1, 2, 3], y: 1 }, // from
  { x: [1, 2, 6], y: 3 }, // to
  { isAssign: false },
);
/** update function is generated by "from" and "to"
 * @param a - from 
 * @param b - status - range 0 - 1
 */
function anonymous(a,b) {
  var a={};var a_x=a["x"]=[];a_x["2"]=3+b*3;a["y"]=1+b*2;return a;
}
// when options "isAssign" is `true` (default);
function anonymous(a,b) {
var a_x=a["x"];a_x["2"]=3+b*3;a["y"]=1+b*2;return a;
}
```

when "from" and "to" value have different structure, console will receive friendly error message

## get start
```html
<script src="https://unpkg.com/tween-animate@2.0.9/dist/tween.umd.js"></script>
```
```shell
yarn add tween-animate
```
```shell
npm install tween-animate
```

### todo
1. beizer easing function
2. more test cases

## develop

### install
```
yarn
```
### start
```
yarn watch
```
### test

```
yarn test
```
### template

```
yarn template
```
then open `http://localhost: 3000`
### build

```
yarn build
```

